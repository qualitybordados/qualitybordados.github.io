{
  "rules": "rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    // Public documents readable by anyone\n    match /publicContent/{document=**} {\n      allow read: if true;\n      allow write: if request.auth != null && request.auth.token.admin == true;\n    }\n\n    // Authenticated users can access their own documents\n    match /users/{userId}/{document=**} {\n      allow read, write: if request.auth != null && request.auth.uid == userId;\n    }\n\n    // Allow authenticated users to create support tickets; only owners and admins can read/update\n    match /supportTickets/{ticketId} {\n      allow create: if request.auth != null;\n      allow read, update, delete: if request.auth != null && (request.auth.uid == resource.data.ownerId || request.auth.token.admin == true);\n    }\n\n    // Default deny; only admins can access other collections\n    match /{document=**} {\n      allow read, write: if request.auth != null && request.auth.token.admin == true;\n    }\n  }\n}"
}
